"use strict";(self.webpackChunkfind_the_time_private=self.webpackChunkfind_the_time_private||[]).push([[145],{3077:function(n,e,t){t.d(e,{gT:function(){return s},Lj:function(){return c},yM:function(){return u},oc:function(){return l},mZ:function(){return d},QM:function(){return v},XM:function(){return f},xC:function(){return h}});var r=t(4569),i=t.n(r),o=t(6712),a="".concat(o.N,"/events"),s=function(n){return i().post("".concat(a),n)},c=function(n){return i().get("".concat(a),{params:{event_id:n}})},u=function(n){return i().post("".concat(a,"/new"),n)},l=function(n,e){return i().post("".concat(a,"/subscribe"),e,{params:{event_id:n}})},d=function(n){return i().post("".concat(a,"/unsubscribe"),{},{params:{event_id:n}})},v=function(n,e){return i().post("".concat(a,"/choose-interval"),e,{params:{event_id:n}})},f=function(n,e){return i().post("".concat(a,"/remove-subscription"),{},{params:{event_id:n,user_id:e}})},h=function(n){return i().post("".concat(a,"/remove"),{},{params:{event_id:n}})}},1049:function(n,e,t){t.d(e,{dE:function(){return r},be:function(){return i},Zn:function(){return o},VA:function(){return a}});var r="MMM D",i="HH:mm",o="YYYY-MM-DD HH:mm:ss",a="DD/MM/YYYY ".concat(i)},2048:function(n,e,t){t.d(e,{lR:function(){return o},XO:function(){return s},Rg:function(){return c}});var r=t(7892),i=t.n(r),o=function(n){return null===n?"notYetScheduled":i()(n.end).isAfter(i()())?"pending":"past"},a={notYetScheduled:"EditCalendar",pending:"Event",past:"EventAvailable"},s=function(n){return a[n]},c=function(n,e){return n.organizedBy.id===e.id?"organizer":n.subscriptions.some((function(n){return n.user.id===e.id}))?"subscriber":"visitor"}},145:function(n,e,t){t.r(e),t.d(e,{default:function(){return Cn}});var r=t(1413),i=t(3433),o=t(5861),a=t(9439),s=t(7757),c=t.n(s),u=t(6871),l=t(2791),d=t(7993),v=t(9331),f=t(753),h=t(1290),p=t(6579),m=t(9448),_=t.n(m),x=t(7838),Z=t(1049),j=t(4499),C=t(184),b=function(n,e){var t=e?"small":"regular";return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(x.Z,{size:t,children:n.format(Z.dE)}),(0,C.jsx)(x.Z,{size:t,children:n.format(Z.be)})]})},g=function(n){return n.current===n.total-1},k={Root:"Interval_Root__8spB2",Root_color_user:"Interval_Root_color_user__AnWQZ",Root_color_current:"Interval_Root_color_current__0hoV7",Root_color_all:"Interval_Root_color_all__k2shi",Root_picked:"Interval_Root_picked__w1UZ9",Details:"Interval_Details__VpV7A",Details_shown:"Interval_Details_shown__p66xr",Start:"Interval_Start__MHPim",End:"Interval_End__cbWfa",RangeHighlight:"Interval_RangeHighlight__BmQlk",RangeHighlight_shown:"Interval_RangeHighlight_shown__GgXMU",IntervalChoiceButtonContainer:"Interval_IntervalChoiceButtonContainer__Tfka+"},S=_().bind(k),y=function(n){var e=n.interval,t=n.column,r=n.rows,i=n.isCurrentUser,o=n.onIntervalChoice,s=(0,l.useState)(!1),c=(0,a.Z)(s,2),u=c[0],d=c[1],v=e.start,f=e.end,p=t.start,m=t.end.diff(p),_=v.diff(p)/m*100,x=f.diff(v)/m*100,Z=g(r);return(0,C.jsxs)("div",{className:S("Root",{Root_picked:u,Root_color_user:!i&&!Z,Root_color_current:i,Root_color_all:Z}),style:{left:"".concat(_,"%"),width:"".concat(x,"%")},onMouseEnter:function(){return d(!0)},onMouseLeave:function(){return d(!1)},children:[Z&&o&&(0,C.jsx)("div",{className:k.IntervalChoiceButtonContainer,children:(0,C.jsx)(h.Z,{icon:"EditCalendar",elementProps:{onClick:function(){return o(e)}}})}),(0,C.jsxs)("div",{className:S("Details",{Details_shown:u}),children:[(0,C.jsx)("div",{className:k.Start,children:b(v,!0)}),(0,C.jsx)("div",{className:k.End,children:b(f,!0)})]}),(0,C.jsx)("div",{className:S("RangeHighlight",{RangeHighlight_shown:u}),style:{top:"-".concat(58*(r.current+1),"px"),height:"".concat(58*(r.total+1),"px")}})]})},I="Subscriptions_Root__S+z23",w="Subscriptions_UserList__95xQC",R="Subscriptions_IntervalList__8+5JC",M="Subscriptions_Min__8hfhR",Y="Subscriptions_Max__7CaG8",N="Subscriptions_IntervalHeader__o8Vlp",E="Subscriptions_UserIntervals__Ip4R9",P="Subscriptions_AvailabilityPickButtonContainer__AP4+t",D=t(2189),A="User_Root__976IA",B="User_Name__51agT",z=function(n){var e=n.user,t=n.rows,r=n.isCurrent,i=n.onRemoval,o=!function(n){return 0===n.current}(t),a=!g(t)&&o&&i,s=(0,D.G)(e);return(0,C.jsxs)("div",{className:A,children:[(0,C.jsx)("p",{className:B,title:s,children:(0,C.jsx)(x.Z,{font:r?"primaryBold":"primary",color:r?"secondary":"primary",clamp:1,children:s})}),a&&(0,C.jsx)(h.Z,{icon:"Close",elementProps:{onClick:function(){return i(e)}}})]})},H=function(n){var e=n.participants,t=n.visitor,r=n.onUserRemoval,o=n.onIntervalChoice,a=n.onAvailabilityPick,s=(0,p.C)((function(n){return n.account})),c=function(n,e){var t=null!==e&&void 0!==e&&e.availability.length?[].concat((0,i.Z)(n),[e]):n,r=t.map((function(n){return n.availability})).reduce((function(n,e){return e.flatMap((function(e){return n.flatMap((function(n){var t=(0,j.E)(n,e);return null!==t?[t]:[]}))}))}));return[].concat((0,i.Z)(t),[{user:{name:"All Participants",email:"",id:""},availability:r}])}(e,t);return(0,C.jsxs)("div",{className:I,children:[(0,C.jsx)("div",{className:w,children:c.map((function(n,e){var t=n.user;return(0,C.jsx)(z,{user:t,rows:{current:e,total:c.length},isCurrent:t.id===s.id,onRemoval:r},e)}))}),c[0].availability.map((function(n,e){var t=n.start,r=n.end;return(0,C.jsxs)("div",{className:R,style:{flexGrow:r.diff(t,"minutes")},children:[(0,C.jsxs)("div",{className:N,children:[(0,C.jsx)("div",{className:M,children:b(t)}),(0,C.jsx)("div",{className:Y,children:b(r)})]}),c.map((function(n,e){var i=n.availability;return(0,C.jsx)("div",{className:E,children:i.filter((function(n){var e=n.start,i=n.end;return e.isSameOrAfter(t)&&i.isSameOrBefore(r)})).map((function(n,i){return(0,C.jsx)(y,{interval:n,column:{start:t,end:r},rows:{current:e,total:c.length},isCurrentUser:c[e].user.id===s.id,onIntervalChoice:o},i)}))},e)})),a&&(0,C.jsx)("div",{className:P,children:(0,C.jsx)(h.Z,{icon:"Add",elementProps:{onClick:function(){return a({start:t,end:r})}}})})]},e)}))]})},T=t(2048),U=t(3527),O=t(5469),L=t(3077),F=t(5249),Q=function(n){var e=n.title,t=void 0===e?"Confirm Action":e,r=n.action,i=n.onConfirm,o=n.onCancel,a=n.isDangerous,s=void 0!==a&&a;return(0,C.jsx)(F.Z,{title:t,onOkClick:i,okProps:s?{theme:"danger"}:void 0,onCancelClick:o,children:(0,C.jsxs)(x.Z,{children:["You are about to ",r,". Do you want to proceed?"]})})},W=t(8586),G=function(n){var e=n.comment;return(0,C.jsx)(W.Z,{heading:"Comment",icon:"Description",children:""===e?(0,C.jsx)(x.Z,{font:"primaryItalic",children:"No additional info provided"}):(0,C.jsx)(x.Z,{children:e})})},V=t(7892),X=t.n(V),q=function(n){var e=n.duration;return(0,C.jsx)(W.Z,{heading:"Duration",icon:"Timelapse",children:(0,C.jsx)(x.Z,{children:X().duration(e,"minutes").humanize()})})},J=t(2261),K=t(6117),$=t(7508),nn=function(n){var e=n.onConfirm,t=n.onCancel,i=n.pickerProps,o=n.eventEnd;return(0,C.jsx)(F.Z,{title:"Choose When Event Happens",onOkClick:e,onCancelClick:t,children:(0,C.jsx)(K.Z,{defaultPreventedOnSubmission:!0,layout:"responsive",children:(0,C.jsxs)(K.Z.Column,{children:[(0,C.jsx)(K.Z.Item,{id:"start",label:"Start",isRequired:!0,children:(0,C.jsx)(J.Z,(0,r.Z)({},i))}),(0,C.jsx)(K.Z.Item,{id:"end",label:"End",children:(0,C.jsx)($.Z,{placeholder:null===o||void 0===o?void 0:o.format(Z.VA),disabled:!0})})]})})})},en=function(n){var e=n.location;return(0,C.jsx)(W.Z,{heading:"Location",icon:"LocationOn",children:(0,C.jsx)(x.Z,{children:e})})},tn=t(4833),rn=function(n){var e=n.organizedBy,t=n.isCurrentUser;return(0,C.jsxs)(W.Z,{heading:"Organized By",icon:"Person",children:[(0,C.jsx)(x.Z,{children:(0,D.G)(e)}),t&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(tn.Z,{}),(0,C.jsx)(x.Z,{font:"primaryItalic",size:"small",children:"That's you!"})]})]})},on=function(n){var e=n.onCopy,t=n.onCancel,r=window.location.href;return(0,C.jsx)(F.Z,{title:"Invite Participants",onOkClick:function(){navigator.clipboard.writeText(r),e()},okText:"Copy",onCancelClick:t,children:(0,C.jsx)($.Z,{icon:"Share",value:r})})},an=function(n,e){return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(x.Z,{children:n}),(0,C.jsx)(tn.Z,{}),(0,C.jsx)(x.Z,{font:"primaryItalic",size:"small",children:e})]})},sn={organizer:"You can pick the time when everyone is subscribed!",subscriber:"The organizer will pick the time when everyone is subscribed!",visitor:"You can subscribe!"},cn=function(n){var e=n.chosenInterval,t=n.role,r=n.status,i={notYetScheduled:an("Not scheduled yet",sn[t]),pending:an("Scheduled for ".concat(X()(null===e||void 0===e?void 0:e.start).format("MMM D, YYYY")),"Will start ".concat(X()(null===e||void 0===e?void 0:e.start).fromNow())),past:an("Was scheduled for ".concat(X()(null===e||void 0===e?void 0:e.start).format("MMM D, YYYY")),"Ended ".concat(X()(null===e||void 0===e?void 0:e.end).fromNow()))};return(0,C.jsx)(W.Z,{heading:"Status",icon:(0,T.XO)(r),children:i[r]})},un="EventDetails_Tiles__pcM-6",ln="EventDetails_Subscriptions__Qb-TF",dn="EventDetails_Buttons__j+QAp",vn=t(7762),fn=t.n(vn),hn=t(2774),pn=function(n){return{start:{startIsBeforeEnd:!0},end:{notShorterThan:{duration:n}},intervals:{noIntersections:!0}}},mn=function(n){var e=n.onConfirm,t=n.onCancel,r=n.constraints,o=n.currentAvailabilities,s=n.duration,c=(0,l.useState)(function(n,e){var t=e.at(-1);if(!t)return n.start;var r=t.end.add(1,"hour");return r.isBetween(n.start,n.end)?r:n.start}(r,o)),u=(0,a.Z)(c,2),d=u[0],v=u[1],f=(0,l.useState)(r.end),h=(0,a.Z)(f,2),p=h[0],m=h[1],_=d&&p?{start:d,end:p}:null,x={start:_,end:_,intervals:[].concat((0,i.Z)(o),[_])},Z=_?fn()(x,pn(s)):void 0;return(0,C.jsxs)(F.Z,{title:"Choose When You're Available",onOkClick:function(){_&&!Z&&e(_)},onCancelClick:t,children:[(0,C.jsx)(hn.Z,{isShown:Boolean(null===Z||void 0===Z?void 0:Z.intervals),children:(null===Z||void 0===Z?void 0:Z.intervals)||""}),(0,C.jsx)(K.Z,{defaultPreventedOnSubmission:!0,layout:"responsive",children:(0,C.jsxs)(K.Z.Column,{children:[(0,C.jsx)(K.Z.Item,{id:"start",label:"Start",errorMessage:null===Z||void 0===Z?void 0:Z.start,isRequired:!0,children:(0,C.jsx)(J.Z,{value:d,onChange:v,constraints:r})}),(0,C.jsx)(K.Z.Item,{id:"end",label:"End",errorMessage:null===Z||void 0===Z?void 0:Z.end,isRequired:!0,children:(0,C.jsx)(J.Z,{value:p,onChange:m,constraints:r})})]})})]})},_n=t(5987),xn=["subscriptions"],Zn=function(n){var e=n.subscriptions,t=(0,_n.Z)(n,xn),i=e.map((function(n){return{user:n.user,availability:n.availability.map((function(n){var e=n.start,t=n.end;return{start:X()(e),end:X()(t)}}))}}));return(0,r.Z)({subscriptions:i},t)},jn={title:"Event Not Found",message:"We couldn\u2019t find this event. Sorry about that.",returnUrl:U.Su.Events,returnButtonText:"Go to events"},Cn=function(n){var e=n.navigateBackTo,t=(0,p.T)(),s=(0,u.s0)(),h=(0,u.UO)().eventId,m=(0,l.useState)(),_=(0,a.Z)(m,2),x=_[0],j=_[1],b=(0,l.useState)(),g=(0,a.Z)(b,2),k=g[0],S=g[1],y=(0,l.useState)(!1),I=(0,a.Z)(y,2),w=I[0],R=I[1],M=(0,l.useState)(),Y=(0,a.Z)(M,2),N=Y[0],E=Y[1],P=(0,l.useState)(null),D=(0,a.Z)(P,2),A=D[0],B=D[1],z=x&&A?A.add(x.duration,"minutes"):null,F=(0,l.useState)(!1),V=(0,a.Z)(F,2),X=V[0],J=V[1],K=(0,l.useState)(),$=(0,a.Z)(K,2),tn=$[0],an=$[1],sn=(0,l.useState)([]),vn=(0,a.Z)(sn,2),fn=vn[0],hn=vn[1],pn=(0,l.useState)(!1),_n=(0,a.Z)(pn,2),xn=_n[0],Cn=_n[1],bn=(0,l.useState)(null),gn=(0,a.Z)(bn,2),kn=gn[0],Sn=gn[1],yn=(0,p.C)((function(n){return n.account})),In=x?(0,T.Rg)(x,yn):null,wn=x?(0,T.lR)(null===x||void 0===x?void 0:x.chosenInterval):null,Rn=(0,l.useCallback)((0,o.Z)(c().mark((function n(){var e,t;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return S(!0),n.prev=1,n.next=4,(0,L.Lj)(h);case 4:e=n.sent,t=Zn(e.data),j(t),S(!1),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(1),S(!1),s(U.Su.NotFound,{state:jn});case 14:case"end":return n.stop()}}),n,null,[[1,10]])}))),[h,s]);(0,l.useEffect)((function(){Rn()}),[Rn]);var Mn=function(){var n=(0,o.Z)(c().mark((function n(){return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Sn(null),S(!0),n.prev=2,n.next=5,(0,L.xC)(h);case 5:S(!1),s(U.Su.Events),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(2),S(!1),t((0,O.H_)("delete the event",n.t0));case 13:case"end":return n.stop()}}),n,null,[[2,9]])})));return function(){return n.apply(this,arguments)}}(),Yn=function(){var n=(0,o.Z)(c().mark((function n(e){return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Sn(null),S(!0),n.prev=2,n.next=5,(0,L.XM)(h,e.id);case 5:Rn(),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(2),t((0,O.H_)("remove this user",n.t0));case 11:return n.prev=11,S(!1),n.finish(11);case 14:case"end":return n.stop()}}),n,null,[[2,8,11,14]])})));return function(e){return n.apply(this,arguments)}}(),Nn=function(){var n=(0,o.Z)(c().mark((function n(){var e;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(A&&z){n.next=2;break}return n.abrupt("return");case 2:return e={start:A.format(Z.Zn),end:z.format(Z.Zn)},S(!0),n.prev=4,n.next=7,(0,L.QM)(h,{chosenInterval:e});case 7:R(!1),Rn(),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(4),t((0,O.H_)("schedule the event",n.t0));case 14:return n.prev=14,S(!1),n.finish(14);case 17:case"end":return n.stop()}}),n,null,[[4,11,14,17]])})));return function(){return n.apply(this,arguments)}}(),En=function(){var n=(0,o.Z)(c().mark((function n(){return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Sn(null),S(!0),n.prev=2,n.next=5,(0,L.mZ)(h);case 5:Rn(),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(2),t((0,O.H_)("unsubscribe you",n.t0));case 11:return n.prev=11,S(!1),n.finish(11);case 14:case"end":return n.stop()}}),n,null,[[2,8,11,14]])})));return function(){return n.apply(this,arguments)}}(),Pn=function(){var n=(0,o.Z)(c().mark((function n(){var e;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=fn.map((function(n){var e=n.start,t=n.end;return{start:e.format(Z.Zn),end:t.format(Z.Zn)}})),S(!0),n.prev=2,n.next=5,(0,L.oc)(h,{availableAt:e});case 5:hn([]),Rn(),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(2),t((0,O.H_)("subscribe you",n.t0));case 12:return n.prev=12,S(!1),n.finish(12);case 15:case"end":return n.stop()}}),n,null,[[2,9,12,15]])})));return function(){return n.apply(this,arguments)}}(),Dn="visitor"===In&&"notYetScheduled"===wn&&Boolean(fn.length),An=Dn,Bn="subscriber"===In&&"notYetScheduled"===wn,zn="organizer"===In&&"notYetScheduled"===wn;return(0,C.jsx)(v.Z,{title:(null===x||void 0===x?void 0:x.title)||"",isLoading:k,navigateBackTo:e,headerAddon:(0,C.jsx)(d.Z,{leftIcon:"Share",elementProps:{onClick:function(){return Cn(!0)}},children:"Share"}),children:x&&In&&wn&&(0,C.jsxs)(C.Fragment,{children:[w&&(0,C.jsx)(nn,{onConfirm:Nn,onCancel:function(){return R(!1)},pickerProps:{value:A,onChange:function(n){return B(n)},constraints:N},eventEnd:z}),tn&&X&&(0,C.jsx)(mn,{onConfirm:function(n){J(!1),hn((function(e){return[].concat((0,i.Z)(e),[n])}))},onCancel:function(){return J(!1)},currentAvailabilities:fn,constraints:tn,duration:x.duration}),xn&&(0,C.jsx)(on,{onCopy:function(){return Cn(!1)},onCancel:function(){return Cn(!1)}}),kn&&(0,C.jsx)(Q,(0,r.Z)((0,r.Z)({},kn),{},{isDangerous:!0})),(0,C.jsxs)("div",{className:un,children:[(0,C.jsx)(rn,{organizedBy:x.organizedBy,isCurrentUser:"organizer"===In}),(0,C.jsx)(en,{location:x.location}),(0,C.jsx)(q,{duration:x.duration}),(0,C.jsx)(cn,{chosenInterval:x.chosenInterval,role:In,status:wn}),(0,C.jsx)(G,{comment:x.comment})]}),(0,C.jsx)("div",{className:ln,children:(0,C.jsx)(W.Z,{icon:"People",heading:"Participants",children:(0,C.jsx)(f.Z,{axis:"horizontal",children:(0,C.jsx)(H,{participants:x.subscriptions,visitor:{user:yn,availability:fn},onUserRemoval:"organizer"===In&&"past"!==wn?function(n){return Sn({title:"Remove Participant",action:"remove this user from participation in the event",onConfirm:function(){return Yn(n)},onCancel:function(){return Sn(null)}})}:void 0,onIntervalChoice:"organizer"===In&&"notYetScheduled"===wn?function(n){var e=n.start,t=n.end;if(x){var r={start:e,end:t.subtract(x.duration,"minutes")};E(r),B(r.start),R(!0)}}:void 0,onAvailabilityPick:"visitor"===In&&"notYetScheduled"===wn?function(n){an(n),J(!0)}:void 0})})})}),(0,C.jsxs)("div",{className:dn,children:[Dn&&(0,C.jsx)(d.Z,{elementProps:{onClick:Pn},children:"Subscribe"}),An&&(0,C.jsx)(d.Z,{elementProps:{onClick:function(){hn([])}},theme:"secondary",children:"Clear selected"}),Bn&&(0,C.jsx)(d.Z,{theme:"danger",elementProps:{onClick:function(){return Sn({title:"Unsubscribe",action:"revoke your participation in this event",onConfirm:En,onCancel:function(){return Sn(null)}})}},children:"Unsubscribe"}),zn&&(0,C.jsx)(d.Z,{theme:"danger",elementProps:{onClick:function(){return Sn({title:"Remove Event",action:"remove this event",onConfirm:Mn,onCancel:function(){return Sn(null)}})}},children:"Delete"})]})]})})}},2261:function(n,e,t){t.d(e,{Z:function(){return u}});var r=t(1413),i=t(9439),o=t(3853),a=t(2791),s=t(7508),c=t(184),u=function(n){var e=n.id,t=n.value,u=n.onChange,l=n.constraints,d=(0,a.useState)(!1),v=(0,i.Z)(d,2),f=v[0],h=v[1];return(0,c.jsx)(o.x,{value:t,onChange:u,open:f,onOpen:function(){return h(!0)},onClose:function(){return h(!1)},minDateTime:null===l||void 0===l?void 0:l.start,maxDateTime:null===l||void 0===l?void 0:l.end,renderInput:function(n){var t=n.inputRef,i=n.inputProps;return(0,c.jsx)(s.Z,(0,r.Z)((0,r.Z)({id:e,onClick:function(){return h(!0)},ref:t},i),{},{readOnly:!0}))}})}}}]);
//# sourceMappingURL=145.57cf508d.chunk.js.map